{"epochs": 100, "current_epoch": 10, "samples_per_epoch": -1, "scale_epoch_size": 0.5, "train_accum_steps": 1, "progress_bar_mode": 2, "progbar_delta_time": 5, "tf_cpp_min_log_level": 2, "force_eager": false, "skip_model_load_test": true, "val_every_n": 1, "lav_every_n": 0, "lav_silent": true, "lav_min_epoch": 0, "output_dir": "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold_3", "write_checkpoints": true, "export_best": true, "export_final": false, "no_train_scope": null, "ema_decay": 0.99, "random_seed": 10, "profile": false, "device": {"gpus": null, "gpu_auto_tune": false, "gpu_memory": null, "soft_device_placement": true, "dist_strategy": "default", "__cls__": "tfaip.device.device_config:DeviceConfigParams"}, "optimizer": {"clip_norm": null, "clip_value": null, "global_clip_norm": 5, "beta_1": 0.9, "beta_2": 0.999, "epsilon": 1e-07, "weight_decay": 1e-05, "__cls__": "tfaip.trainer.optimizer.optimizers:AdamOptimizer"}, "learning_rate": {"lr": 0.001, "step_function": true, "offset_epochs": 0, "steps_per_epoch": 15577, "epochs": 100, "__cls__": "tfaip.trainer.scheduler.constant_params:Constant"}, "scenario": {"debug_graph_n_examples": 1, "print_eval_limit": 10, "tensorboard_logger_history_size": 5, "export_serve": true, "model": {"layers": [{"name": "conv2d_0", "filters": 40, "kernel_size": {"x": 3, "y": 3, "__cls__": "calamari_ocr.ocr.model.layers.layer:IntVec2D"}, "strides": {"x": 1, "y": 1, "__cls__": "calamari_ocr.ocr.model.layers.layer:IntVec2D"}, "padding": "same", "activation": "relu", "__cls__": "calamari_ocr.ocr.model.layers.conv2d:Conv2DLayerParams"}, {"name": "maxpool2d_0", "pool_size": {"x": 2, "y": 2, "__cls__": "calamari_ocr.ocr.model.layers.layer:IntVec2D"}, "strides": {"x": -1, "y": -1, "__cls__": "calamari_ocr.ocr.model.layers.layer:IntVec2D"}, "padding": "same", "__cls__": "calamari_ocr.ocr.model.layers.pool2d:MaxPool2DLayerParams"}, {"name": "conv2d_1", "filters": 60, "kernel_size": {"x": 3, "y": 3, "__cls__": "calamari_ocr.ocr.model.layers.layer:IntVec2D"}, "strides": {"x": 1, "y": 1, "__cls__": "calamari_ocr.ocr.model.layers.layer:IntVec2D"}, "padding": "same", "activation": "relu", "__cls__": "calamari_ocr.ocr.model.layers.conv2d:Conv2DLayerParams"}, {"name": "maxpool2d_1", "pool_size": {"x": 2, "y": 2, "__cls__": "calamari_ocr.ocr.model.layers.layer:IntVec2D"}, "strides": {"x": -1, "y": -1, "__cls__": "calamari_ocr.ocr.model.layers.layer:IntVec2D"}, "padding": "same", "__cls__": "calamari_ocr.ocr.model.layers.pool2d:MaxPool2DLayerParams"}, {"name": "conv2d_2", "filters": 120, "kernel_size": {"x": 3, "y": 3, "__cls__": "calamari_ocr.ocr.model.layers.layer:IntVec2D"}, "strides": {"x": 1, "y": 1, "__cls__": "calamari_ocr.ocr.model.layers.layer:IntVec2D"}, "padding": "same", "activation": "relu", "__cls__": "calamari_ocr.ocr.model.layers.conv2d:Conv2DLayerParams"}, {"name": "lstm_0", "hidden_nodes": 200, "merge_mode": "concat", "__cls__": "calamari_ocr.ocr.model.layers.bilstm:BiLSTMLayerParams"}, {"name": "lstm_1", "hidden_nodes": 200, "merge_mode": "concat", "__cls__": "calamari_ocr.ocr.model.layers.bilstm:BiLSTMLayerParams"}, {"name": "lstm_2", "hidden_nodes": 200, "merge_mode": "concat", "__cls__": "calamari_ocr.ocr.model.layers.bilstm:BiLSTMLayerParams"}, {"name": "dropout_0", "rate": 0.5, "__cls__": "calamari_ocr.ocr.model.layers.dropout:DropoutLayerParams"}], "classes": 370, "ctc_merge_repeated": true, "ensemble": 0, "masking_mode": false, "__cls__": "calamari_ocr.ocr.model.params:ModelParams"}, "data": {"pre_proc": {"run_parallel": true, "num_threads": -1, "max_tasks_per_process": 250, "processors": [{"modes": ["training", "evaluation", "prediction"], "extra_params": [4, 1.0, 0.3], "line_height": 48, "__cls__": "calamari_ocr.ocr.dataset.imageprocessors.center_normalizer:CenterNormalizerProcessorParams"}, {"modes": ["training", "evaluation", "prediction"], "normalize": true, "invert": true, "transpose": true, "pad": 16, "pad_value": 0, "__cls__": "calamari_ocr.ocr.dataset.imageprocessors.final_preparation:FinalPreparationProcessorParams"}, {"modes": ["training", "targets", "evaluation", "prediction"], "bidi_direction": "auto", "__cls__": "calamari_ocr.ocr.dataset.textprocessors.basic_text_processors:BidiTextProcessorParams"}, {"modes": ["training", "targets", "evaluation", "prediction"], "__cls__": "calamari_ocr.ocr.dataset.textprocessors.basic_text_processors:StripTextProcessorParams"}, {"modes": ["training", "targets", "evaluation", "prediction"], "unicode_normalization": "NFC", "__cls__": "calamari_ocr.ocr.dataset.textprocessors.text_normalizer:TextNormalizerProcessorParams"}, {"modes": ["training", "targets", "evaluation", "prediction"], "replacements": [{"old": "(?u)\\s+", "new": " ", "regex": true}, {"old": "(?u)\\n", "new": "", "regex": true}, {"old": "(?u)^\\s+", "new": "", "regex": true}, {"old": "(?u)\\s+$", "new": "", "regex": true}], "rulesets": ["spaces"], "rulegroups": [], "__cls__": "calamari_ocr.ocr.dataset.textprocessors.text_regularizer:TextRegularizerProcessorParams"}, {"modes": ["training", "evaluation", "prediction"], "max_line_width": 4096, "__cls__": "calamari_ocr.ocr.dataset.imageprocessors.preparesample:PrepareSampleProcessorParams"}], "__cls__": "tfaip.data.pipeline.processor.params:SequentialProcessorPipelineParams"}, "post_proc": {"run_parallel": false, "num_threads": -1, "max_tasks_per_process": 250, "processors": [{"modes": ["training", "targets", "evaluation", "prediction"], "__cls__": "calamari_ocr.ocr.dataset.postprocessors.reshape:ReshapeOutputsProcessorParams"}, {"modes": ["training", "targets", "evaluation", "prediction"], "ctc_decoder_params": {"type": "default", "blank_index": 0, "min_p_threshold": 0, "non_word_chars": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "[", "]", "(", ")", "_", ".", ":", ";", "!", "?", "{", "}", "-", "'", "\""], "dictionary": [], "word_separator": " ", "__cls__": "calamari_ocr.ocr.model.ctcdecoder.ctc_decoder:CTCDecoderParams"}, "__cls__": "calamari_ocr.ocr.dataset.postprocessors.ctcdecoder:CTCDecoderProcessorParams"}, {"modes": ["training", "targets", "evaluation", "prediction"], "bidi_direction": "auto", "__cls__": "calamari_ocr.ocr.dataset.textprocessors.basic_text_processors:BidiTextProcessorParams"}, {"modes": ["training", "targets", "evaluation", "prediction"], "__cls__": "calamari_ocr.ocr.dataset.textprocessors.basic_text_processors:StripTextProcessorParams"}, {"modes": ["training", "targets", "evaluation", "prediction"], "unicode_normalization": "NFC", "__cls__": "calamari_ocr.ocr.dataset.textprocessors.text_normalizer:TextNormalizerProcessorParams"}, {"modes": ["training", "targets", "evaluation", "prediction"], "replacements": [{"old": "(?u)\\s+", "new": " ", "regex": true}, {"old": "(?u)\\n", "new": "", "regex": true}, {"old": "(?u)^\\s+", "new": "", "regex": true}, {"old": "(?u)\\s+$", "new": "", "regex": true}], "rulesets": ["spaces"], "rulegroups": [], "__cls__": "calamari_ocr.ocr.dataset.textprocessors.text_regularizer:TextRegularizerProcessorParams"}], "__cls__": "tfaip.data.pipeline.processor.params:SequentialProcessorPipelineParams"}, "resource_base_path": ".", "skip_invalid_gt": true, "input_channels": 1, "downscale_factor": 4, "line_height": 48, "ensemble": 0, "codec": {"charset": ["", " ", "!", "\"", "#", "$", "%", "&", "'", "(", ")", "*", ",", "-", ".", "/", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", ":", ";", "=", ">", "?", "@", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "[", "\\", "]", "^", "_", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "{", "|", "}", "\u00a7", "\u00ab", "\u00b0", "\u00b6", "\u00b7", "\u00b9", "\u00bb", "\u00bc", "\u00bd", "\u00be", "\u00c0", "\u00c4", "\u00c6", "\u00c7", "\u00c8", "\u00c9", "\u00ca", "\u00cb", "\u00ce", "\u00cf", "\u00d2", "\u00d3", "\u00d4", "\u00d6", "\u00dc", "\u00df", "\u00e0", "\u00e1", "\u00e2", "\u00e3", "\u00e4", "\u00e5", "\u00e6", "\u00e7", "\u00e8", "\u00e9", "\u00ea", "\u00eb", "\u00ec", "\u00ed", "\u00ee", "\u00ef", "\u00f0", "\u00f1", "\u00f2", "\u00f3", "\u00f4", "\u00f5", "\u00f6", "\u00f9", "\u00fa", "\u00fb", "\u00fc", "\u00ff", "\u0101", "\u0107", "\u0111", "\u0113", "\u0115", "\u0119", "\u0129", "\u012b", "\u0133", "\u013a", "\u0142", "\u014b", "\u014d", "\u0152", "\u0153", "\u0159", "\u0169", "\u016b", "\u016f", "\u017f", "\u01b7", "\u01bf", "\u01f5", "\u0207", "\u0223", "\u0233", "\u0292", "\u02d6", "\u0301", "\u0303", "\u0304", "\u0308", "\u030a", "\u0315", "\u0342", "\u0357", "\u0364", "\u0365", "\u0366", "\u0391", "\u0392", "\u0393", "\u0394", "\u0398", "\u039b", "\u03a0", "\u03a3", "\u03a4", "\u03a6", "\u03ac", "\u03ad", "\u03ae", "\u03af", "\u03b1", "\u03b2", "\u03b3", "\u03b4", "\u03b5", "\u03b6", "\u03b7", "\u03b8", "\u03b9", "\u03ba", "\u03bb", "\u03bc", "\u03bd", "\u03be", "\u03bf", "\u03c0", "\u03c1", "\u03c2", "\u03c3", "\u03c4", "\u03c5", "\u03c6", "\u03c7", "\u03c8", "\u03c9", "\u03ca", "\u03cb", "\u03cc", "\u03cd", "\u03ce", "\u03d1", "\u03d6", "\u03df", "\u03e7", "\u03f0", "\u03f1", "\u0451", "\u0452", "\u0454", "\u05d0", "\u05d1", "\u05d4", "\u05d5", "\u05d6", "\u05d7", "\u05d9", "\u05db", "\u05de", "\u05e0", "\u05e1", "\u05e4", "\u05e7", "\u05e8", "\u05e9", "\u05ea", "\u1d10", "\u1dce", "\u1dd1", "\u1dd3", "\u1de3", "\u1e7d", "\u1e85", "\u1e9c", "\u1ebd", "\u1ef9", "\u1f00", "\u1f04", "\u1f08", "\u1f10", "\u1f11", "\u1f30", "\u1f38", "\u1f40", "\u1f41", "\u1f50", "\u1f70", "\u1f74", "\u1f76", "\u1f78", "\u1fbd", "\u1fc6", "\u1fd6", "\u1fe4", "\u1fe5", "\u1fe6", "\u1ff3", "\u1ff6", "\u201a", "\u201b", "\u201e", "\u201f", "\u2020", "\u2022", "\u2023", "\u203a", "\u204a", "\u2081", "\u2086", "\u2114", "\u2116", "\u211e", "\u2132", "\u2133", "\u214e", "\u2154", "\u2159", "\u2183", "\u2184", "\u2218", "\u2219", "\u2292", "\u2299", "\u23d1", "\u23d3", "\u25a0", "\u25bd", "\u2609", "\u263d", "\u263f", "\u2640", "\u2642", "\u2643", "\u2644", "\u2648", "\u2649", "\u264a", "\u264b", "\u264c", "\u264d", "\u264e", "\u264f", "\u2650", "\u2651", "\u2652", "\u2653", "\u2e17", "\u2e4a", "\ua751", "\ua753", "\ua757", "\ua758", "\ua759", "\ua75d", "\ua76b", "\ua76d", "\ua770", "\ua776", "\ue44d", "\ue5b1", "\ue5d2", "\ue5dc", "\ue665", "\ue8bf", "\ueada", "\ueba1", "\ueba3", "\ueba5", "\ueba6", "\ueec5", "\ueed9", "\uf02f", "\uf1bb", "\uf1cc", "\uf4f9", "\ufb00", "\ufb02", "\ufb06", "\ufe0e", "\u271d", "\u2720", "\u29ec"], "__cls__": "calamari_ocr.ocr.dataset.codec:Codec"}, "__cls__": "calamari_ocr.ocr.dataset.params:DataParams"}, "evaluator": {"__cls__": "tfaip.evaluator.params:EvaluatorParams"}, "export_net_config": false, "net_config_filename": "net_config.json", "default_serve_dir": "3.ckpt.h5", "additional_serve_dir": "additional", "trainer_params_filename": "3.ckpt.json", "scenario_params_filename": "scenario_params.json", "scenario_base_path": "/home/ls6/reul/calamari/calamari_ocr/ocr/scenario.py", "scenario_id": "calamari_ocr.ocr.scenario:CalamariScenario", "id": "fold_3_calamari_ocr.ocr.scenario:CalamariScenario_2022-01-04", "tfaip_commit_hash": null, "tfaip_version": "1.2.4", "__cls__": "calamari_ocr.ocr.scenario_params:CalamariScenarioParams"}, "warmstart": {"model": "/scratch/zpd/data/ground-truth/ptr/models/mm/lsh4-all-deep3/19.ckpt.h5", "allow_partial": false, "trim_graph_name": false, "rename": [], "add_suffix": "", "rename_targets": [], "exclude": null, "include": null, "auto_remove_numbers_for": ["lstm_cell"], "__cls__": "tfaip.trainer.warmstart.warmstart_params:WarmStartParams"}, "early_stopping": {"best_model_output_dir": "/scratch/zpd/data/ground-truth/ptr/models/mm/lsh4-deep3-ref_incl-eval", "best_model_name": "", "frequency": 1, "n_to_go": 5, "lower_threshold": 0.0, "upper_threshold": 0.9, "mode": "min", "current": 0.015789905562996864, "monitor": "val_CER", "n": 1, "__cls__": "tfaip.trainer.callbacks.earlystopping.params:EarlyStoppingParams"}, "gen": {"setup": {"train": {"batch_size": 5, "limit": -1, "prefetch": 32, "num_processes": 8, "batch_drop_remainder": false, "shuffle_buffer_size": 10000, "mode": "training", "bucket_boundaries": [], "bucket_batch_sizes": null, "__cls__": "tfaip.data.databaseparams:DataPipelineParams"}, "val": {"batch_size": 16, "limit": -1, "prefetch": 32, "num_processes": 8, "batch_drop_remainder": false, "shuffle_buffer_size": -1, "mode": "evaluation", "bucket_boundaries": [], "bucket_batch_sizes": null, "__cls__": "tfaip.data.databaseparams:DataPipelineParams"}, "__cls__": "tfaip.trainer.params:TrainerPipelines"}, "train": {"channels": 1, "to_gray_method": "cv", "skip_invalid": true, "non_existing_as_empty": false, "n_folds": 0, "preload": false, "files": ["/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold0_000.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold0_001.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold0_002.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold0_003.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold1_000.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold1_001.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold1_002.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold1_003.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold2_000.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold2_001.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold2_002.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold2_003.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold4_000.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold4_001.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold4_002.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold4_003.h5"], "pred_extension": ".pred.xml", "__cls__": "calamari_ocr.ocr.dataset.datareader.hdf5.reader:Hdf5"}, "val": {"channels": 1, "to_gray_method": "cv", "skip_invalid": true, "non_existing_as_empty": false, "n_folds": 0, "preload": false, "files": ["/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold3_000.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold3_001.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold3_002.h5", "/home/ls6/reul/temp/lsh4-deep3-ref_incl-eval/fold3_003.h5"], "pred_extension": ".pred.xml", "__cls__": "calamari_ocr.ocr.dataset.datareader.hdf5.reader:Hdf5"}, "__cls__": "calamari_ocr.ocr.training.pipeline_params:CalamariDefaultTrainerPipelineParams"}, "saved_checkpoint_sub_dir": "checkpoint/checkpoint_0009", "checkpoint_sub_dir": "checkpoint/checkpoint_{epoch:04d}", "checkpoint_save_freq": "epoch", "version": 5, "data_aug_retrain_on_original": true, "current_stage": 1, "scale_epoch_size_no_da_train": -1, "progress_bar": true, "auto_upgrade_checkpoints": true, "codec": {"keep_loaded": true, "auto_compute": true, "include": [], "include_files": [], "resolved_include_chars": ["\u2640", "\u00fb", "\u00fc", "E", "\u017f", "\u00ed", "\u2609", "C", "\u264a", "\u2652", "\u0111", "\u1fe6", "\u1f10", "\u1f70", "\ua758", "8", "\u0101", "\uf4f9", "\u0115", "\u014b", "\u0107", "\u05e1", "\\", "\u02d6", "\u0113", "\u00f9", "\uf1bb", "H", "\u00b6", "\ua776", "\u00e1", "/", "\u00c0", "\u03ad", "\u00f4", "\u263f", "\ua76d", "\u00e7", "\uf1cc", "\u05e8", "\u03e7", "\u0391", "\u00ff", "6", "z", "!", "\u0308", "\u264d", "L", ")", "\ueba3", "X", "\u1fe5", "\ue8bf", "\u00ec", "\u0169", "\u05d1", "\u03b2", "\ueec5", "\u00e8", "W", "s", "\ufb02", "\u00e3", "\u05d5", "\u0393", "\u1ef9", "\u00d4", "\u03b7", "\u00f2", "\u2644", "\u264e", "\u211e", "t", "N", "\u03c6", "\u0315", "\u0133", "\u00b9", "\u201a", "\u05d4", "\u1f00", "I", "y", "\ua753", "\u1fc6", "\ua76b", "4", "\u00ef", "\u03ce", "\u03ae", "\u00e4", "x", "J", "K", "\u016b", "\u05ea", "\u0223", "q", "d", "\ua757", "\u03be", "g", "\u00c7", "\u03ba", "\u1dce", "\ua75d", "\u00e2", "\u00c6", "\u0303", "\ueed9", "?", "\u00e6", "\u00d6", "\u0364", "\u00c9", "m", "\u012b", "\u05d9", "f", "c", "\u00f5", "\u00c4", "\u03b9", "\u1e85", "@", "D", "u", "\u2292", "\u03b1", "\u03a3", "\u03c2", "O", "\u2643", "\u264f", "\u05d6", "\u00b0", "\u00ab", "\u00bb", "p", "\u00b7", "\u204a", "\u1dd3", "v", "9", ",", "_", "\u00f0", "\u0301", "T", "\u014d", "\u016f", "\u00f3", "\ueba1", "\u2086", "\ue5b1", "a", "\ueba6", "\u00c8", "\u03c4", "r", "V", "\u264b", "Z", "\u05d0", "5", "3", "\u03c3", "\u1dd1", "\u29ec", "\u0142", "\u03bb", "\u00d3", "\u1de3", "\u1e9c", "0", "\u0207", "\u05de", "\u03c9", "\u03b4", "2", "\u2184", "[", "Q", ";", "\u03c1", ":", "\uf02f", "\u00ee", "j", "\u03bc", "\u0152", "\u2651", "b", " ", "\ueada", "h", "P", "\u1ebd", "'", "R", "\u00eb", "\u0304", "\u263d", "\u0233", "\u00df", "M", "\u2642", ".", "F", "=", "\u05d7", "*", "\u05e0", "B", "\u03c0", "\u2653", "\u05e4", "\u1f78", "\u05e7", "\ue44d", "\u0452", ">", "\"", "\u00f6", "\u2e4a", "S", "Y", "\u01b7", "\u05db", "\u00ca", "\u1f76", "\ua759", "\u2720", "\u00e9", "(", "\u03cc", "\u03c7", "\u0365", "\ua770", "e", "]", "\u0292", "\u03b8", "\u03d6", "1", "\u03ac", "U", "-", "\u00fa", "i", "\ueba5", "\u0119", "n", "l", "\u030a", "\u2e17", "\ufb00", "\u00f1", "\u1fe4", "\u00ea", "\u03bd", "\u0342", "\u2081", "\u1d10", "w", "\u00dc", "\u03bf", "\u00e0", "\u1ff6", "k", "\u03b3", "\ua751", "A", "G", "o", "\u2022", "\u0129", "#", "\ufb06", "\u0366", "|", "\u03c5", "&", "\u25bd", "\u00a7", "\u2649", "\u0153", "\u00bd", "\u271d", "\ufe0e", "\u05e9", "\u03b5", "7"], "__cls__": "calamari_ocr.ocr.dataset.codec:CodecConstructionParams"}, "best_model_prefix": "3", "__cls__": "calamari_ocr.ocr.training.params:TrainerParams"}